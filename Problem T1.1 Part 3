# -----------------------------
# Method 3: 4th-Order Polynomial Fit
# -----------------------------

# Data
temps = [33, 34, 40, 51, 60, 69, 75, 74, 67, 56, 47, 38]
t_month = [16 + 31*i for i in range(12)]
total_days = 12*31

# Target days
t_feb19 = 32 + 18
t_july4 = 187 + 3
t_dec25 = 342 + 24

# Degree
degree = 4
n = len(t_month)

# Build normal equations: A * coeffs = b
A = [[0.0]*(degree+1) for _ in range(degree+1)]
b = [0.0]*(degree+1)

for i in range(degree+1):
    for j in range(degree+1):
        A[i][j] = sum(t_month[k]**(i+j) for k in range(n))
    b[i] = sum(temps[k]*(t_month[k]**i) for k in range(n))

# Gaussian elimination
def gaussian_elimination(A, b):
    N = len(b)
    for i in range(N):
        pivot = A[i][i]
        for j in range(i, N):
            A[i][j] /= pivot
        b[i] /= pivot
        for k in range(N):
            if k != i:
                factor = A[k][i]
                for j in range(i, N):
                    A[k][j] -= factor*A[i][j]
                b[k] -= factor*b[i]
    return b

coeffs = gaussian_elimination(A, b)

# Polynomial evaluator
def poly4(t):
    total = 0.0
    for i in range(len(coeffs)):
        total += coeffs[i]*t**i
    return total

# Results
print("Method 3: 4th-Order Polynomial Fit")
print("Feb 19:", round(poly4(t_feb19), 2))
print("July 4:", round(poly4(t_july4), 2))
print("Dec 25:", round(poly4(t_dec25), 2))
print("Coefficients a0..a4:", [round(c,6) for c in coeffs])
